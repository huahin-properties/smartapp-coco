<script>
  const API = "https://script.google.com/macros/s/AKfycbyOnZc6s05eGvHR5XmRnRPAat8vNZpf8cFhL2GiAFjWld-2OBf2OqgP07RU07UTZgDXxA/exec";
  
  async function load() {
    try {
      // ✅ เปลี่ยน mode เป็น getListSmall เพื่อความเร็วสูงสุด
      const res = await fetch(`${API}?mode=getListSmall&t=${Date.now()}`);
      const data = await res.json();
      
      const container = document.getElementById('unitList');
      container.innerHTML = data.map(u => {
        const isAvail = String(u.Status||"").toLowerCase().includes("avail");
        return `
          <div class="t-row">
            <div class="c-img"><div class="thumb-box"><img src="${u.Thumbnail_Image}" loading="lazy"></div></div>
            <div class="c-info"><span class="id-tag">${u.HP_ID}</span></div>
            <div class="c-plot"><span class="plot-tag">${u.Plot || '-'}</span></div>
            <div class="c-status"><div class="dot-group"><div class="dot ${isAvail?'dot-green':''}"></div><div class="dot"></div></div></div>
            <div class="c-edit"><a href="edit.html?id=${u.HP_ID}" class="btn-edit-icon"><i class="fa-regular fa-pen-to-square"></i></a></div>
          </div>`;
      }).join('');
    } catch(e) { console.error(e); }
  }
  window.onload = load;
</script>
