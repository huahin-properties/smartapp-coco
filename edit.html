<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <title>PROPERTY EDITOR | THE COCO</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Montserrat', sans-serif; background:#F0F2F5; }
    .tab-active { border-bottom:4px solid #0F172A; color:#0F172A; }
    .input-card { background:white; padding:1.5rem; border-radius:2rem; box-shadow:0 10px 25px rgba(0,0,0,0.02); }
    .field-label { font-size:.65rem; font-weight:700; color:#64748B; text-transform:uppercase; margin-bottom:.5rem; letter-spacing: 1px; display: block; }
    .field-input { width:100%; border:1px solid #E2E8F0; border-radius:1rem; padding:.85rem; outline:none; font-size: 0.9rem; }
  </style>
</head>
<body class="p-4 md:p-10 italic">
  <div class="max-w-5xl mx-auto">
    <div class="bg-slate-900 rounded-[3rem] p-8 md:p-12 text-white flex justify-between items-center mb-8 shadow-2xl">
      <div>
        <p class="text-blue-400 font-bold uppercase tracking-widest text-[10px] mb-2">Master Database Editor</p>
        <h1 id="unitIdDisplay" class="text-3xl sm:text-5xl font-bold tracking-tighter italic">HP00-XXXX</h1>
      </div>
      <button onclick="history.back()" class="bg-white/10 hover:bg-white/20 p-5 rounded-2xl transition-all">‚úï</button>
    </div>

    <div class="flex gap-8 mb-8 border-b border-slate-200">
      <button id="btnPhoto" onclick="switchTab('photo')" class="pb-4 font-bold text-slate-400 tab-active uppercase text-xs tracking-widest">Cover & Gallery</button>
      <button id="btnInfo" onclick="switchTab('info')" class="pb-4 font-bold text-slate-400 uppercase text-xs tracking-widest">Property Data</button>
    </div>

    <div id="tabPhoto" class="space-y-6">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="input-card">
          <span class="field-label">Main Cover Thumbnail</span>
          <div id="thumbPreview" class="h-56 bg-slate-50 rounded-[1.5rem] border-2 border-dashed flex items-center justify-center overflow-hidden mb-4">üñºÔ∏è</div>
          <button class="w-full py-4 bg-slate-900 text-white rounded-xl font-bold uppercase text-[10px] tracking-widest">Upload Cover</button>
        </div>
        <div class="input-card">
          <span class="field-label">Project Gallery Album</span>
          <div id="galleryPreview" class="h-56 bg-slate-50 rounded-[1.5rem] border-2 border-dashed p-4 flex items-center justify-center mb-4">üóÇÔ∏è</div>
          <button class="w-full py-4 bg-purple-600 text-white rounded-xl font-bold uppercase text-[10px] tracking-widest">Add Gallery Photos</button>
        </div>
      </div>
    </div>

    <div id="tabInfo" class="hidden space-y-6">
      <div class="input-card grid grid-cols-1 md:grid-cols-3 gap-6">
        <div><span class="field-label">Plot Number</span><input id="Plot" class="field-input"></div>
        <div><span class="field-label">Living Area (sq.m)</span><input id="Living_Area" class="field-input"></div>
        <div><span class="field-label">Price (THB)</span><input id="Price" class="field-input font-bold text-blue-600"></div>
        <div class="col-span-full"><span class="field-label">Description</span><textarea id="Description" rows="4" class="field-input"></textarea></div>
      </div>
    </div>

    <button id="saveBtn" class="w-full mt-10 py-8 bg-slate-900 text-white rounded-[3rem] font-bold uppercase tracking-[0.5em] shadow-2xl hover:bg-blue-600 transition-all active:scale-95">Update Master Database</button>
  </div>

  <script>
    // ‚úÖ Updated with your URL
    const API_URL = "https://script.google.com/macros/s/AKfycbyOnZc6s05eGvHR5XmRnRPAat8vNZpf8cFhL2GiAFjWld-2OBf2OqgP07RU07UTZgDXxA/exec";
    const hpId = new URLSearchParams(window.location.search).get('id');
    
    function switchTab(t) {
      document.getElementById('tabPhoto').classList.toggle('hidden', t!=='photo');
      document.getElementById('tabInfo').classList.toggle('hidden', t!=='info');
      document.getElementById('btnPhoto').classList.toggle('tab-active', t==='photo');
      document.getElementById('btnInfo').classList.toggle('tab-active', t==='info');
    }

    async function loadUnit() {
      if(!hpId) return;
      document.getElementById('unitIdDisplay').innerText = hpId;
      try {
        const res = await fetch(`${API_URL}?mode=getUnitDetail&hpId=${hpId}`);
        const data = await res.json();
        if(data) {
          document.getElementById('Plot').value = data.Plot || "";
          document.getElementById('Price').value = data.Price || "";
          document.getElementById('Description').value = data.Description || "";
          if(data.Thumbnail_Image) document.getElementById('thumbPreview').innerHTML = `<img src="${data.Thumbnail_Image}" class="w-full h-full object-cover">`;
        }
      } catch(e) {}
    }
    loadUnit();
  </script>
</body>
</html>
