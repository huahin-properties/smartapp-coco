<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Master Editor | THE COCO</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background: #F0F2F5; font-family: 'Montserrat', sans-serif; }
    .card { background: #fff; padding: 2rem; border-radius: 2.5rem; border: 1px solid rgba(0,0,0,0.03); }
    .input { width: 100%; border: 1px solid #E2E8F0; border-radius: 1rem; padding: 0.9rem; outline: none; font-size: 0.9rem; font-weight: 500; margin-bottom: 1rem; }
    .label { font-size: 0.65rem; font-weight: 700; color: #64748B; text-transform: uppercase; margin-bottom: 0.4rem; display: block; letter-spacing: 1px; }
  </style>
</head>
<body class="p-6 md:p-12 italic">
  <div class="max-w-5xl mx-auto">
    <div class="bg-slate-900 rounded-[3rem] p-10 text-white flex justify-between items-center mb-8 shadow-2xl">
      <div><p class="text-blue-400 font-bold uppercase text-[10px] tracking-widest mb-1">Master Database Editor</p><h1 id="hpId" class="text-4xl md:text-5xl font-bold tracking-tighter">HP00-XXXX</h1></div>
      <button onclick="history.back()" class="bg-white/10 p-5 rounded-2xl">âœ•</button>
    </div>
    
    <div class="card grid grid-cols-1 md:grid-cols-3 gap-6">
      <div><span class="label">Plot</span><input id="Plot" class="input"></div>
      <div><span class="label">Price (THB)</span><input id="Sale_Price" class="input font-bold text-blue-600"></div>
      <div><span class="label">Status</span><select id="Status" class="input"><option value="Available">Available</option><option value="Sold">Sold</option></select></div>
      <div class="col-span-full"><span class="label">Living Area (SQ.M)</span><input id="Living_Area_sq_m" class="input"></div>
      <div class="col-span-full"><span class="label">Description</span><textarea id="Description" rows="5" class="input"></textarea></div>
    </div>

    <button onclick="save()" id="sBtn" class="w-full mt-10 py-8 bg-slate-900 text-white rounded-[3rem] font-bold uppercase tracking-[0.4em] shadow-2xl hover:bg-blue-600 active:scale-95 transition-all">Update Master Database</button>
  </div>
  <script>
    const API = "https://script.google.com/macros/s/AKfycbyOnZc6s05eGvHR5XmRnRPAat8vNZpf8cFhL2GiAFjWld-2OBf2OqgP07RU07UTZgDXxA/exec";
    const hpId = new URLSearchParams(location.search).get('id');
    async function load() {
      document.getElementById('hpId').innerText = hpId;
      const res = await fetch(`${API}?mode=getUnitDetail&hpId=${hpId}`);
      const u = await res.json();
      if(u) {
        document.getElementById('Plot').value = u.Plot || "";
        document.getElementById('Sale_Price').value = u.Sale_Price || "";
        document.getElementById('Living_Area_sq_m').value = u.Living_Area_sq_m || "";
        document.getElementById('Description').value = u.Description || "";
        document.getElementById('Status').value = u.Status || "Available";
      }
    }
    async function save() {
      const b = document.getElementById('sBtn'); b.innerText = "UPDATING...";
      const payload = { mode: "updateUnit", HP_ID: hpId, Plot: document.getElementById('Plot').value, Sale_Price: document.getElementById('Sale_Price').value, Living_Area_sq_m: document.getElementById('Living_Area_sq_m').value, Description: document.getElementById('Description').value, Status: document.getElementById('Status').value };
      await fetch(API, { method: "POST", body: JSON.stringify(payload) });
      alert("Updated Successfully!"); location.href='dashboard.html';
    }
    load();
  </script>
</body>
</html>
