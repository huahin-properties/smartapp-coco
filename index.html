<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover"/>
  <title>CoCo Portfolio | V82</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600&family=Playfair+Display:wght@700&display=swap" rel="stylesheet"/>
  <style>
    :root { --coco: #2D5A27; --border: rgba(45,90,39,0.08); }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { background: #fff; color: #1A3017; font-family: 'Montserrat', sans-serif; -webkit-font-smoothing: antialiased; }
    #pageSplash { position: fixed; inset: 0; background: #FFFFFF; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10000; transition: 0.4s; }
    .leaf-anim { font-size: 50px; animation: swing 1.5s infinite alternate; }
    @keyframes swing { from { transform: rotate(-10deg); } to { transform: rotate(10deg); } }
    header { position: fixed; top: 0; width: 100%; height: 60px; background: rgba(255,255,255,0.9); backdrop-filter: blur(15px); z-index: 1000; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; padding: 0 15px; }
    .logo { font-family: 'Playfair Display', serif; font-size: 1rem; color: var(--coco); text-decoration: none; font-weight: 700; letter-spacing: 1px; }
    .admin-gate { text-decoration: none; width: 38px; height: 38px; background: #0F172A; color: white; border-radius: 12px; display: flex; align-items: center; justify-content: center; }
    .hero { padding: 85px 15px 10px; text-align: center; }
    .search-bar { width: 100%; max-width: 500px; border: 1px solid var(--border); border-radius: 50px; padding: 14px 24px; font-size: 0.9rem; outline: none; background: #F9FBF9; }
    .prop-grid { padding: 15px; display: grid; grid-template-columns: 1fr; gap: 12px; }
    .card { background: #fff; border: 1px solid var(--border); border-radius: 15px; display: flex; height: 95px; overflow: hidden; text-decoration: none; color: inherit; transition: transform 0.2s; box-shadow: 0 4px 15px rgba(0,0,0,0.02); }
    .card:active { transform: scale(0.97); }
    .card-img { width: 130px; background: #eee; flex-shrink: 0; }
    .card-img img { width: 100%; height: 100%; object-fit: cover; }
    .card-info { flex: 1; padding: 10px 15px; display: flex; flex-direction: column; justify-content: center; }
    .p-title { font-size: 0.8rem; font-weight: 600; color: var(--coco); }
    .p-price { font-size: 1rem; font-weight: 700; color: var(--coco); margin: 2px 0; }
    .p-meta { font-size: 0.55rem; color: #6B7A68; text-transform: uppercase; font-weight: 400; letter-spacing: 0.5px; }
    @media (min-width: 768px) { .prop-grid { grid-template-columns: 1fr 1fr; } }
  </style>
</head>
<body>
  <div id="pageSplash"><div class="leaf-anim">ðŸŒ¿</div><div style="letter-spacing:4px; font-size:0.6rem; color:var(--coco); margin-top:10px;">LOADING EXCLUSIVE CATALOG</div></div>
  <header><a href="#" class="logo">THE COCO</a><a href="gateway.html" class="admin-gate">ðŸ”’</a></header>
  <section class="hero"><input type="text" id="q" class="search-bar" placeholder="Search Plot or ID..." oninput="search()"></section>
  <main class="prop-grid" id="grid"></main>

  <script>
    const API = 'https://script.google.com/macros/s/AKfycbyOnZc6s05eGvHR5XmRnRPAat8vNZpf8cFhL2GiAFjWld-2OBf2OqgP07RU07UTZgDXxA/exec';
    let data = [];

    // [PROFESSIONAL] à¸à¸¥à¹„à¸à¹‚à¸«à¸¥à¸”à¹€à¸£à¹‡à¸§: à¹à¸ªà¸”à¸‡ Cache à¸à¹ˆà¸­à¸™ -> à¸­à¸±à¸›à¹€à¸”à¸•à¸«à¸¥à¸±à¸‡à¸šà¹‰à¸²à¸™ -> à¹à¸à¹‰à¸„à¹‰à¸²à¸‡
    async function init() {
      const cached = localStorage.getItem('coco_v82');
      if (cached) { data = JSON.parse(cached); render(data); setTimeout(() => hideSplash(), 200); }

      try {
        const controller = new AbortController();
        const tid = setTimeout(() => controller.abort(), 6000); // 6s Timeout
        const res = await fetch(`${API}?mode=getListSmall&v=${Date.now()}`, { signal: controller.signal });
        const json = await res.json();
        clearTimeout(tid);
        if (Array.isArray(json)) {
          data = json;
          localStorage.setItem('coco_v82', JSON.stringify(data));
          render(data);
          hideSplash();
        }
      } catch (e) { hideSplash(); }
    }

    function render(items) {
      document.getElementById('grid').innerHTML = items.map(u => {
        let p = parseFloat(String(u.Sale_Price || 0).replace(/[^0-9.]/g, ''));
        return `<a href="details.html?id=${u.HP_ID}" class="card">
          <div class="card-img"><img src="${u.Thumbnail_Image || 'https://via.placeholder.com/130x95'}" loading="lazy"></div>
          <div class="card-info">
            <div class="p-title">Plot ${u.Plot || u.HP_ID}</div>
            <div class="p-price">à¸¿${p.toLocaleString()}</div>
            <div class="p-meta">${u.Bedrooms||0} Bed | ${u.Living_Area_sq_m||0} mÂ² | ${u.Status}</div>
          </div>
        </a>`;
      }).join('');
    }

    function search() {
      const val = document.getElementById('q').value.toLowerCase();
      render(data.filter(u => u.HP_ID.toLowerCase().includes(val) || u.Plot.toLowerCase().includes(val)));
    }

    function hideSplash() { 
      const s = document.getElementById('pageSplash'); 
      if(s) { s.style.opacity = '0'; setTimeout(()=>s.style.display='none', 400); } 
    }
    init();
  </script>
</body>
</html>
